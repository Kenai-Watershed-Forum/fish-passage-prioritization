<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Methods – Kenai Peninsula Borough Fish Passage Prioritization Data Synthesis [DRAFT]</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./results.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./methods.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Methods</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Kenai Peninsula Borough Fish Passage Prioritization Data Synthesis [DRAFT]</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Kenai-Watershed-Forum/fish-passage-prioritization" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Kenai-Peninsula-Borough-Fish-Passage-Prioritization-Data-Synthesis-[DRAFT].docx" title="Download Docx" class="quarto-navigation-tool px-1" aria-label="Download Docx"><i class="bi bi-file-word"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methods.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-and-integrate-datasets" id="toc-load-and-integrate-datasets" class="nav-link active" data-scroll-target="#load-and-integrate-datasets"><span class="header-section-number">1.1</span> Load and Integrate Datasets</a></li>
  <li><a href="#assign-priority-points-based-on-physical-attributes" id="toc-assign-priority-points-based-on-physical-attributes" class="nav-link" data-scroll-target="#assign-priority-points-based-on-physical-attributes"><span class="header-section-number">1.2</span> Assign Priority Points based on Physical Attributes</a></li>
  <li><a href="#assign-priority-points-based-on-ecological-attributes" id="toc-assign-priority-points-based-on-ecological-attributes" class="nav-link" data-scroll-target="#assign-priority-points-based-on-ecological-attributes"><span class="header-section-number">1.3</span> Assign Priority Points based on Ecological Attributes</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Kenai-Watershed-Forum/fish-passage-prioritization/edit/main/methods.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Methods</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Methods described within this document are primarily for purposes of sharing example code to synthesize multiple fish passage datasets. A more detailed report with an expanded methods section is available for download at the link below.</p>
<section id="load-and-integrate-datasets" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="load-and-integrate-datasets"><span class="header-section-number">1.1</span> Load and Integrate Datasets</h2>
<p>We used the following datasets on Kenai Peninsula Borough area stream crossings to create the combined dataset:</p>
<ul>
<li><p>Fish Barrier Hunter 2022 (U.S. Fish &amp; Wildlife Service)</p></li>
<li><p>Fish Barrier Hunter 2023 (U.S. Fish &amp; Wildlife Service)</p></li>
<li><p>2024 Anadromous Waters Catalog inventory (Alaska Department of Fish and Game)</p></li>
<li><p>AquaticBarriers.org</p></li>
</ul>
<p>Additional datasets may be integrated by modifying the script below, displayed by clicking the “Code” button. All scripts are hosted in Kenai Watershed Forum’s <a href="https://github.com/Kenai-Watershed-Forum/fish-passage-prioritization/">GitHub account</a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">### 1. Load Datasets </span><span class="al">###</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all data sets here</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Can also use read_excel() to load .xlsx and .xls files</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>data_aquatic_barriers <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"other/input/formatted_data/Aquaticbarriers/aquatic_barrier_ranks_aquaticbarriers_org.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">"c"</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data_ADFG <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"other/input/formatted_data/ADFG/Kenai_culvert_prioritization_ADFG.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">"c"</span>)) </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>data_FWS_FBH22 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"other/input/formatted_data/USFWS/2022fishbarrierhunter.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">"c"</span>)) </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>data_FWS_FBH23 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"other/input/formatted_data/USFWS/2023fishbarrierhunter.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">"c"</span>)) </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>data_FWS_Kenai <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"other/input/formatted_data/USFWS/Kenai USFWS Fish Passage_Projects_Needs_ 12_20_23.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">"c"</span>)) </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">### 2. Format Labels </span><span class="al">###</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create formatted labels to create links between subsets and master set</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>labels_aquatic_barriers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"data source"</span>, <span class="st">"Latitude"</span>, <span class="st">"Longitude"</span>, <span class="st">"Name"</span>, <span class="st">"SARPID"</span>, <span class="st">"Source"</span>, <span class="st">"Snapped"</span>, <span class="st">"NHDPlusID"</span>, <span class="st">"StreamSizeClass"</span>, <span class="st">"LocalID"</span>, <span class="st">"CrossingCode"</span>, <span class="st">"NearestCrossingID"</span>, <span class="st">"Stream Name"</span>, <span class="st">"AnnualVelocity"</span>, <span class="st">"AnnualFlow"</span>, <span class="st">"TotDASqKm"</span>, <span class="st">"Road Name"</span>, <span class="st">"RoadType"</span>, <span class="st">"Structure Type"</span>, <span class="st">"Constriction_Ratio"</span>, <span class="st">"PotentialProject"</span>, <span class="st">"BarrierSeverity"</span>, <span class="st">"SARP_Score"</span>, <span class="st">"Recon"</span>, <span class="st">"Removed"</span>, <span class="st">"YearRemoved"</span>, <span class="st">"Condition"</span>, <span class="st">"PassageFacility"</span>, <span class="st">"TESpp"</span>, <span class="st">"StateSGCNSpp"</span>, <span class="st">"RegionalSGCNSpp"</span>, <span class="st">"Trout"</span>, <span class="st">"Landownership"</span>, <span class="st">"BarrierOwnerType"</span>, <span class="st">"ProtectedLand"</span>, <span class="st">"External Report Links"</span>, <span class="st">"EJTract"</span>, <span class="st">"EJTribal"</span>, <span class="st">"Basin"</span>, <span class="st">"Subbasin"</span>, <span class="st">"Subwatershed"</span>, <span class="st">"HUC2"</span>, <span class="st">"HUC6"</span>, <span class="st">"HUC8"</span>, <span class="st">"HUC10"</span>, <span class="st">"HUC12"</span>, <span class="st">"State"</span>, <span class="st">"County"</span>, <span class="st">"Excluded"</span>, <span class="st">"Invasive"</span>, <span class="st">"OnLoop"</span>, <span class="st">"HasNetwork"</span>, <span class="st">"Ranked"</span>, <span class="st">"Intermittent"</span>, <span class="st">"StreamOrder"</span>, <span class="st">"Landcover"</span>, <span class="st">"SizeClasses"</span>, <span class="st">"TotalUpstreamMiles"</span>, <span class="st">"PerennialUpstreamMiles"</span>, <span class="st">"Reported_Upstream_Fish_Habitat_miles"</span>, <span class="st">"AlteredUpstreamMiles"</span>, <span class="st">"UnalteredUpstreamMiles"</span>, <span class="st">"PerennialUnalteredUpstreamMiles"</span>, <span class="st">"TotalDownstreamMiles"</span>, <span class="st">"FreeDownstreamMiles"</span>, <span class="st">"FreePerennialDownstreamMiles"</span>, <span class="st">"FreeIntermittentDownstreamMiles"</span>, <span class="st">"FreeAlteredDownstreamMiles"</span>, <span class="st">"FreeUnalteredDownstreamMiles"</span>, <span class="st">"GainMiles"</span>, <span class="st">"PerennialGainMiles"</span>, <span class="st">"TotalNetworkMiles"</span>, <span class="st">"TotalPerennialNetworkMiles"</span>, <span class="st">"PercentUnaltered"</span>, <span class="st">"PercentPerennialUnaltered"</span>, <span class="st">"UpstreamDrainageArea"</span>, <span class="st">"UpstreamWaterfalls"</span>, <span class="st">"UpstreamDams"</span>, <span class="st">"UpstreamSmallBarriers"</span>, <span class="st">"UpstreamRoadCrossings"</span>, <span class="st">"UpstreamHeadwaters"</span>, <span class="st">"TotalUpstreamRoadCrossings"</span>, <span class="st">"TotalDownstreamWaterfalls"</span>, <span class="st">"TotalDownstreamDams"</span>, <span class="st">"TotalDownstreamSmallBarriers"</span>, <span class="st">"MilesToOutlet"</span>, <span class="st">"FlowsToOcean"</span>, <span class="st">"FlowsToGreatLakes"</span>, <span class="st">"ExitsRegion"</span>) <span class="co"># nolint:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>labels_ADFG <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ADF&amp;G Crossing Code"</span>, <span class="st">"ADF&amp;G rating"</span>, <span class="st">"Sport Fish Area Boundary"</span>, <span class="st">"Area, Region, Quad or City"</span>, <span class="st">"Road Name"</span>, <span class="st">"Stream Name"</span>, <span class="st">"Prioritization"</span>, <span class="st">"AWCStreamNo"</span>, <span class="st">"Miles Used for Scoring"</span>, <span class="st">"MSB Culverts to 16pc Gradient with Green culverts removed "</span>, <span class="st">"Reported_Upstream_Fish_Habitat_miles"</span>, <span class="st">"Pre-2022 Miles Data to NEXT BARRIER or END"</span>, <span class="st">"AWC Miles U/S- "</span>, <span class="st">"Acres of Lake"</span>, <span class="st">"Fish_Species_Composition"</span>, <span class="st">"No of Anadromous Species"</span>, <span class="st">"Resident AFFI- Needs to be updated."</span>, <span class="st">"No of resident species"</span>, <span class="st">"Red/Gray rating"</span>, <span class="st">"Rating w/ Perch"</span>, <span class="st">"Perch_Height"</span>, <span class="st">"Perch"</span>, <span class="st">"Latitude"</span>, <span class="st">"Longitude"</span>, <span class="st">"Additional Notes"</span>) <span class="co"># nolint:</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>labels_FWS_FBH22 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"ObjectID"</span>, <span class="st">"GlobalID"</span>, <span class="st">"CreationDate"</span>, <span class="st">"Creator"</span>, <span class="st">"EditDate"</span>, <span class="st">"Editor"</span>, <span class="st">"Date and Time Observed:"</span>, <span class="st">"Observer Name:"</span>, <span class="st">"Observer Phone:"</span>, <span class="st">"Number of Culverts at your Crossing Site:"</span>, <span class="st">"Culvert Material:"</span>, <span class="st">"Other - Culvert Material:"</span>, <span class="st">"Closest Town:"</span>, <span class="st">"Stream Name"</span>, <span class="st">"Enter more data?"</span>, <span class="st">"Tributary to:"</span>, <span class="st">"Subwatershed Name:"</span>, <span class="st">"Road Name"</span>, <span class="st">"Road Elevation:"</span>, <span class="st">"Road Surface:"</span>, <span class="st">"Landownership"</span>, <span class="st">"Culvert Condition:"</span>, <span class="st">"Structure Type"</span>, <span class="st">"Channel Wetted Width (feet):"</span>, <span class="st">"Upstream_OHWM_feet"</span>, <span class="st">"Upstream_Bankfull_Width_feet"</span>, <span class="st">"Road Fill Height Over Top of Culvert:"</span>, <span class="st">"Tidal Site"</span>, <span class="st">"Structure Wetted Width at Inlet (feet):"</span>, <span class="st">"Water Depth at Inlet (feet):"</span>, <span class="st">"Substrate width in Culvert:"</span>, <span class="st">"Percent of Inlet Blocked by Debris:"</span>, <span class="st">"Grate at Inlet:"</span>, <span class="st">"Visible Deformation"</span>, <span class="st">"Structure Wetted Width at Outlet (feet):"</span>, <span class="st">"Water Depth at Outlet (feet):"</span>, <span class="st">"Percent of Outlet Blocked by Debris:"</span>, <span class="st">"Grate at Outlet:"</span>, <span class="st">"Visible Deformation at Outlet:"</span>, <span class="st">"Perch_Height"</span>, <span class="st">"Outlet Scour Pool"</span>, <span class="st">"Would you like to add data for more culverts?"</span>, <span class="st">"Culvert or Bridge Cell 2 of:"</span>, <span class="st">"Cell 2 Structure Type:"</span>, <span class="st">"Cell 2 Inlet Structure Width:"</span>, <span class="st">"Cell 2 Inlet Structure Height above Water:"</span>, <span class="st">"Cell 2 Inlet Structure Wetted Width:"</span>, <span class="st">"Cell 2 Inlet Water Depth:"</span>, <span class="st">"Cell 2 Outlet Structure Width:"</span>, <span class="st">"Cell 2 Outlet Structure Height above Water:"</span>, <span class="st">"Cell 2 Outlet Wetted Width:"</span>, <span class="st">"Cell 2 Outlet Water Depth:"</span>, <span class="st">"Culvert or Bridge Cell 3 of:"</span>, <span class="st">"Cell 3 Structure Type:"</span>, <span class="st">"Cell 3 Inlet Structure Width:"</span>, <span class="st">"Cell 3 Inlet Structure Height above Water:"</span>, <span class="st">"Cell 3 Inlet Structure Wetted Width:"</span>, <span class="st">"Cell 3 Inlet Water Depth:"</span>, <span class="st">"Cell 3 Outlet Structure Width:"</span>, <span class="st">"Cell 3 Outlet Structure Height above Water:"</span>, <span class="st">"Cell 3 Outlet Wetted Width:"</span>, <span class="st">"Cell 3 Outlet Water Depth:"</span>, <span class="st">"Culvert or Bridge Cell 4 of:"</span>, <span class="st">"Cell 4 Structure Type:"</span>, <span class="st">"Cell 4 Inlet Structure Width:"</span>, <span class="st">"Cell 4 Inlet Structure Height above Water:"</span>, <span class="st">"Cell 4 Inlet Structure Wetted Width:"</span>, <span class="st">"Cell 4 Inlet Water Depth:"</span>, <span class="st">"Cell 4 Outlet Structure Width:"</span>, <span class="st">"Cell 4 Outlet Structure Height above Water:"</span>, <span class="st">"Cell 4 Outlet Wetted Width:"</span>, <span class="st">"Cell 4 Outlet Water Depth:"</span>, <span class="st">"Perched Culvert:"</span>, <span class="st">"Are you on private land?"</span>, <span class="st">"Please Fill Out Volunteer Form Below."</span>, <span class="st">"Would you like to enter more data?"</span>, <span class="st">"Fish Species Present"</span>, <span class="st">"Length of Culvert (feet):"</span>, <span class="st">"Enter additional photos?"</span>, <span class="st">"Is there a hydraulic jump at the inlet?"</span>, <span class="st">"Fish Passage Barrier Severity"</span>, <span class="st">"Notes"</span>, <span class="st">"Is there a known site identification number for this crossing?"</span>, <span class="st">"Known Site ID (ADF&amp;G No.)"</span>, <span class="st">"Additional Note for ADFG"</span>, <span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>) <span class="co"># nolint:</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>labels_FWS_FBH23 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"ObjectID"</span>, <span class="st">"GlobalID"</span>, <span class="st">"CreationDa"</span>, <span class="st">"Creator"</span>, <span class="st">"EditDate"</span>, <span class="st">"Editor"</span>, <span class="st">"Date_and_T"</span>, <span class="st">"Observer_N"</span>, <span class="st">"Observer_P"</span>, <span class="st">"Number_of_"</span>, <span class="st">"Culvert_Ma"</span>, <span class="st">"Other___Cu"</span>, <span class="st">"Closest_To"</span>, <span class="st">"Stream Name"</span>, <span class="st">"Enter_more"</span>, <span class="st">"Tributary_"</span>, <span class="st">"Subwatersh"</span>, <span class="st">"Road Name"</span>, <span class="st">"Road_Eleva"</span>, <span class="st">"Road_Surfa"</span>, <span class="st">"Landownership"</span>, <span class="st">"Culvert_Co"</span>, <span class="st">"Structure Type"</span>, <span class="st">"Channel_We"</span>, <span class="st">"Upstream_OHWM_feet"</span>, <span class="st">"Upstream_Bankfull_Width_feet"</span>, <span class="st">"Road_Fill_"</span>, <span class="st">"Tidal Site"</span>, <span class="st">"Structure1"</span>, <span class="st">"Water_Dept"</span>, <span class="st">"Structur_1"</span>, <span class="st">"Water_De_1"</span>, <span class="st">"Substrate_"</span>, <span class="st">"Percent_of"</span>, <span class="st">"Grate_at_I"</span>, <span class="st">"Visible Deformation"</span>, <span class="st">"Structur_2"</span>, <span class="st">"Water_De_2"</span>, <span class="st">"Structur_3"</span>, <span class="st">"Water_De_3"</span>, <span class="st">"Percent__1"</span>, <span class="st">"Grate_at_O"</span>, <span class="st">"Visible__1"</span>, <span class="st">"Perch_Height"</span>, <span class="st">"Scour_Pool"</span>, <span class="st">"Would_you_"</span>, <span class="st">"Culvert_or"</span>, <span class="st">"Cell_2_Str"</span>, <span class="st">"Cell_2_Inl"</span>, <span class="st">"Cell_2_I_1"</span>, <span class="st">"Cell_2_I_2"</span>, <span class="st">"Cell_2_I_3"</span>, <span class="st">"Cell_2_Out"</span>, <span class="st">"Cell_2_O_1"</span>, <span class="st">"Cell_2_O_2"</span>, <span class="st">"Cell_2_O_3"</span>, <span class="st">"Culvert__1"</span>, <span class="st">"Cell_3_Str"</span>, <span class="st">"Cell_3_Inl"</span>, <span class="st">"Cell_3_I_1"</span>, <span class="st">"Cell_3_I_2"</span>, <span class="st">"Cell_3_I_3"</span>, <span class="st">"Cell_3_Out"</span>, <span class="st">"Cell_3_O_1"</span>, <span class="st">"Cell_3_O_2"</span>, <span class="st">"Cell_3_O_3"</span>, <span class="st">"Culvert__2"</span>, <span class="st">"Cell_4_Str"</span>, <span class="st">"Cell_4_Inl"</span>, <span class="st">"Cell_4_I_1"</span>, <span class="st">"Cell_4_I_2"</span>, <span class="st">"Cell_4_I_3"</span>, <span class="st">"Cell_4_Out"</span>, <span class="st">"Cell_4_O_1"</span>, <span class="st">"Cell_4_O_2"</span>, <span class="st">"Cell_4_O_3"</span>, <span class="st">"Perched_Cu"</span>, <span class="st">"Are_you_on"</span>, <span class="st">"Please_Fil"</span>, <span class="st">"Would_you1"</span>, <span class="st">"Fish_Speci"</span>, <span class="st">"Length_of_"</span>, <span class="st">"Enter_addi"</span>, <span class="st">"Length_of1"</span>, <span class="st">"Is_there_a"</span>, <span class="st">"Fish_Passa"</span>, <span class="st">"Notes"</span>, <span class="st">"Is_there_1"</span>, <span class="st">"Known_Site"</span>, <span class="st">"x_1"</span>, <span class="st">"y_1"</span>, <span class="st">"Additional"</span>, <span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>) <span class="co"># nolint:</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>labels_FWS_Kenai <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"area"</span>, <span class="st">"category"</span>, <span class="st">"Title "</span>, <span class="st">"Replacement Date"</span>, <span class="st">"Replacement Date Notes"</span>, <span class="st">"ADF&amp;G Crossing Code"</span>, <span class="st">"KWF ID#"</span>, <span class="st">"Alt ID"</span>, <span class="st">"Landownership"</span>, <span class="st">"Funding "</span>, <span class="st">"Category"</span>, <span class="st">"Latitude"</span>, <span class="st">"Longitude"</span>, <span class="st">"Last Eval"</span>, <span class="st">"Reported_Upstream_Fish_Habitat_miles"</span>, <span class="st">"Reported_Upstream_Lake_Fish_Habitat_acres"</span>, <span class="st">"upstream habitat notes"</span>, <span class="st">"Salmon Species"</span>, <span class="st">"Issue"</span>, <span class="st">"Additional Notes"</span>) </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="do">### 3. Prepare Master Dataset </span><span class="al">###</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">Sys.Date</span>(), <span class="st">"%m%d%Y"</span>) <span class="co"># MMDDYYYY format</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Column Header Labels Defined Here, Items can be added, rearranged, or removed. # nolint:</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>master_column_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Latitude"</span>, <span class="st">"Longitude"</span>, <span class="st">"Priority_Total"</span>, <span class="st">"Priority_Ecological"</span>, <span class="st">"Priority_Physical"</span>, <span class="st">"KPB Crossing Code"</span>, <span class="st">"ADF&amp;G Crossing Code"</span>, <span class="st">"Fish_Species_Composition"</span>, <span class="co"># nolint:</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ADF&amp;G rating"</span>, <span class="st">"Stream Name"</span>, <span class="st">"Road Name"</span>, <span class="st">"Structure Type"</span>, <span class="st">"Structure Dimensions"</span>, <span class="st">"Structure_Slope"</span>, <span class="st">"Perch_Height"</span>, <span class="co"># nolint:</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Outlet Scour Pool"</span>, <span class="st">"Constriction_Ratio"</span>, <span class="st">"NHD+ Upstream Fish Habitat miles"</span>, <span class="st">"Reported_Upstream_Fish_Habitat_miles"</span>, <span class="co"># nolint:</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Reported_Upstream_Lake_Fish_Habitat_acres"</span>, <span class="st">"Upstream_OHWM_feet"</span>, <span class="st">"Upstream_Bankfull_Width_feet"</span>, <span class="st">"Road Material and Fill Height Over Top of Culvert"</span>, <span class="co"># nolint:</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tidal Site"</span>, <span class="st">"Visible Deformation"</span>, <span class="st">"Landownership"</span>, <span class="st">"External Report Links"</span>, <span class="st">"Additional Notes"</span> <span class="co"># nolint:</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="do">### 4. Relabel sub-data column names to prepare for combining </span><span class="al">###</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">#  REMOVES any column that doesn't match the master column label list</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>data_aquatic_barriers <span class="ot">&lt;-</span> <span class="fu">set_names</span>(data_aquatic_barriers, labels_aquatic_barriers) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">any_of</span>(master_column_labels)) <span class="co"># nolint:</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>data_ADFG <span class="ot">&lt;-</span> <span class="fu">set_names</span>(data_ADFG, labels_ADFG) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">any_of</span>(master_column_labels)) <span class="co"># nolint:</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>data_FWS_FBH22 <span class="ot">&lt;-</span> <span class="fu">set_names</span>(data_FWS_FBH22, labels_FWS_FBH22) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">any_of</span>(master_column_labels)) <span class="co"># nolint:</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>data_FWS_FBH23 <span class="ot">&lt;-</span> <span class="fu">set_names</span>(data_FWS_FBH23, labels_FWS_FBH23) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">any_of</span>(master_column_labels)) <span class="co"># nolint:</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>data_FWS_Kenai <span class="ot">&lt;-</span> <span class="fu">set_names</span>(data_FWS_Kenai, labels_FWS_Kenai) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">any_of</span>(master_column_labels)) <span class="co"># nolint:</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="do">### 5. Correct errors in data set merging here to prep for bind_rows() </span><span class="al">###</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Note here the only error so far is duplicated lines in this one dataset</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>data_FWS_FBH23 <span class="ot">&lt;-</span> data_FWS_FBH23[, <span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">as.list</span>(data_FWS_FBH23))] <span class="co"># nolint:</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="do">### 6. Combine data sets </span><span class="al">###</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>merged_data_set <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_aquatic_barriers, data_ADFG, data_FWS_FBH22, data_FWS_FBH23, data_FWS_Kenai) <span class="co"># nolint:</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 6.b Identify missing columns that didn't have any data linkages</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates blank columns for missing items and rearranges the columns into the master_column_labels order # nolint:</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>missing_cols <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(master_column_labels, <span class="fu">colnames</span>(merged_data_set))</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="do">### 7. Manipulate data as needed </span><span class="al">###</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>merged_data_set <span class="ot">&lt;-</span> merged_data_set <span class="sc">|&gt;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Latitude =</span> <span class="fu">as.numeric</span>(Latitude)) <span class="sc">|&gt;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Longitude =</span> <span class="fu">as.numeric</span>(Longitude)) <span class="sc">|&gt;</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Reported_Upstream_Fish_Habitat_miles =</span> <span class="fu">as.numeric</span>(Reported_Upstream_Fish_Habitat_miles)) <span class="sc">|&gt;</span> <span class="co"># nolint:</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Upstream_OHWM_feet =</span> <span class="fu">as.numeric</span>(Upstream_OHWM_feet)) <span class="sc">|&gt;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Upstream_Bankfull_Width_feet =</span> <span class="fu">as.numeric</span>(Upstream_Bankfull_Width_feet)) <span class="sc">|&gt;</span> <span class="co"># nolint:</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Reported_Upstream_Lake_Fish_Habitat_acres =</span> <span class="fu">as.numeric</span>(Reported_Upstream_Lake_Fish_Habitat_acres)) <span class="sc">|&gt;</span> <span class="co"># nolint:</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="sc">!!!</span><span class="fu">set_names</span>(<span class="fu">map</span>(missing_cols, <span class="sc">~</span><span class="cn">NA_real_</span>), missing_cols)) <span class="sc">|&gt;</span> <span class="co"># Adds any columns that are missing from the master_column_labels # nolint:</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(master_column_labels)) <span class="co"># Sorts the columns to be in the same order as master_column_labels # nolint:</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct text entries in Perch Height</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>merged_data_set <span class="ot">&lt;-</span> merged_data_set <span class="sc">|&gt;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Perch_Height =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>      Perch_Height <span class="sc">==</span> <span class="st">"&gt;1_0'"</span> <span class="sc">~</span> <span class="st">"1.5"</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>      Perch_Height <span class="sc">==</span> <span class="st">"&lt;_5'"</span> <span class="sc">~</span> <span class="st">"0.5"</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>      Perch_Height <span class="sc">==</span> <span class="st">"0_5'_1_0'"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> Perch_Height <span class="co"># Keep other values as they are</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Perch_Height =</span> <span class="fu">as.numeric</span>(Perch_Height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="assign-priority-points-based-on-physical-attributes" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="assign-priority-points-based-on-physical-attributes"><span class="header-section-number">1.2</span> Assign Priority Points based on Physical Attributes</h2>
<p>We assigned ranking values on a scale of 1-10 for physical attributes associated with each site in the study area, which included:</p>
<ul>
<li>Perch height</li>
<li>Crossing width to OHW (ordinary high water) ratio</li>
<li>Constriction</li>
<li>Crossing slope</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 8. Assign Priority Points based on Physical Attributes </span><span class="al">###</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.a Perch Height (ft)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>function_perch_height_pts <span class="ot">&lt;-</span> <span class="cf">function</span>(value) {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">0.25</span> <span class="sc">~</span> <span class="fl">2.5</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">0.75</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fl">7.5</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> <span class="co"># assigned to blank values</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.b Culvert Constriction</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>function_constriction_pts <span class="ot">&lt;-</span> <span class="cf">function</span>(value) {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;=</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="fl">2.5</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;=</span> <span class="fl">0.6</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;=</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="fl">7.5</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> <span class="co"># assigned to blank values</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 8.c Crossing Slope (%)</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>function_crossing_slope_pts <span class="ot">&lt;-</span> <span class="cf">function</span>(value) {</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">1.5</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">2.5</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">3.5</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">4.0</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;</span> <span class="fl">4.0</span> <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> <span class="co"># assigned to blank values</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="assign-priority-points-based-on-ecological-attributes" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="assign-priority-points-based-on-ecological-attributes"><span class="header-section-number">1.3</span> Assign Priority Points based on Ecological Attributes</h2>
<p>We assigned ranking values on a scale of 1-10 for ecological attributes associated with each site in the study area, which included:</p>
<ul>
<li>Fish species composition</li>
<li>Linear (stream) habitat quantity upstream</li>
<li>Area (lake) habitat quantity upstream
<ul>
<li><em>Note: the original analysis plan intended to use predicted (probable) upstream habitat quantity rather than solely known (documented) habitat quantity. The task was determined to beyond the scope of this project, but future analysis should incorporate this task. See the “Summary” chapter for details.</em></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 9. Assign Priority Points based on Ecological Attributes </span><span class="al">###</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.a Presence of Anadromous Species vs. Resident (count)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>function_anadromous_pts <span class="ot">&lt;-</span> <span class="cf">function</span>(value) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  species_list <span class="ot">&lt;-</span> <span class="fu">str_split</span>(value, <span class="st">","</span>,<span class="at">simplify=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  species_list <span class="ot">&lt;-</span> <span class="fu">unlist</span>(species_list)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  anadromous_species_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CO"</span>, <span class="st">"COr"</span>, <span class="st">"COs"</span>, <span class="st">"COsr"</span>, <span class="st">"COp"</span>, <span class="st">"k"</span>, <span class="st">"Kr"</span>, <span class="st">"Ks"</span>, <span class="st">"Ksr"</span>, <span class="st">"Kp"</span>, <span class="st">"S"</span>, <span class="st">"Sr"</span>, <span class="st">"Ss"</span>, <span class="st">"Ssr"</span>, <span class="st">"Sp"</span>, <span class="st">"P"</span>, <span class="st">"Pr"</span>, <span class="st">"Ps"</span>, <span class="st">"Psr"</span>, <span class="st">"Pp"</span>, <span class="st">"CH"</span>, <span class="st">"CHr"</span>, <span class="st">"CHs"</span>, <span class="st">"CHsr"</span>, <span class="st">"CHp"</span>, <span class="st">"SH"</span>, <span class="st">"SHr"</span>, <span class="st">"SHs"</span>, <span class="st">"SHsr"</span>, <span class="st">"SHp"</span>) <span class="co"># nolint:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  resident_species_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DV"</span>, <span class="st">"DVr"</span>, <span class="st">"DVs"</span>, <span class="st">"DVsr"</span>, <span class="st">"DVp"</span>, <span class="st">"W"</span>, <span class="st">"Wr"</span>, <span class="st">"Ws"</span>, <span class="st">"Wsr"</span>, <span class="st">"Wp"</span>) <span class="co"># nolint:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  number_anadromous <span class="ot">&lt;-</span> <span class="fu">sum</span>(species_list <span class="sc">%in%</span> anadromous_species_list)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  number_resident <span class="ot">&lt;-</span> <span class="fu">sum</span>(species_list <span class="sc">%in%</span> resident_species_list)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(species_list) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (number_anadromous <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> number_resident <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (number_anadromous <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> number_resident <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">5</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (number_anadromous <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">8</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (number_anadromous <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">10</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.b Upstream Drainage Length (linear miles)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>function_upstream_length_pts <span class="ot">&lt;-</span> <span class="cf">function</span>(value) {</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">0.25</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">1.0</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="fl">1.5</span> <span class="sc">~</span> <span class="dv">8</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;</span> <span class="fl">1.5</span> <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> <span class="co"># assigned to blank values</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.c Upstream Drainage Area (acres)</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>function_upstream_area_pts <span class="ot">&lt;-</span> <span class="cf">function</span>(value) {</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span> <span class="fl">2.5</span>,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">~</span> <span class="fl">7.5</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    value <span class="sc">&gt;</span> <span class="dv">15</span> <span class="sc">~</span> <span class="dv">10</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> <span class="co"># assigned to blank values</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="do">### 10. Calculate points and update priority field </span><span class="al">###</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Physical Priority</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>merged_data_set <span class="ot">&lt;-</span> merged_data_set <span class="sc">|&gt;</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Priority_Physical =</span> <span class="fu">function_perch_height_pts</span>(Perch_Height) <span class="sc">+</span> <span class="fu">function_constriction_pts</span>(Constriction_Ratio) <span class="sc">+</span> <span class="fu">function_crossing_slope_pts</span>(Structure_Slope)) <span class="sc">|&gt;</span> <span class="co"># nolint:</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Ecological Priority</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>merged_data_set <span class="ot">&lt;-</span> merged_data_set <span class="sc">|&gt;</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Priority_Ecological =</span> <span class="fu">function_anadromous_pts</span>(Fish_Species_Composition) <span class="sc">+</span> <span class="fu">function_upstream_length_pts</span>(Reported_Upstream_Fish_Habitat_miles) <span class="sc">+</span> <span class="fu">function_upstream_area_pts</span>(Reported_Upstream_Lake_Fish_Habitat_acres)) <span class="sc">|&gt;</span> <span class="co"># nolint:</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Total Priority</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>merged_data_set <span class="ot">&lt;-</span> merged_data_set <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Priority_Total =</span> Priority_Physical <span class="sc">+</span> Priority_Ecological) <span class="co"># nolint:</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="do">### 11. Write Data to Excel Sheet </span><span class="al">###</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates new .xlsx file for the master sheet in the current directory with the current date. # nolint:</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>master_data_set_file_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"other/output/"</span>,<span class="st">"CombinedData_"</span>, today, <span class="st">".xlsx"</span>)</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">createWorkbook</span>()</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Data"</span>)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="dv">1</span>, (merged_data_set), <span class="at">startRow =</span> <span class="dv">1</span>, <span class="at">startCol =</span> <span class="dv">1</span>)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Master Set to Excel File in current directory</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWorkbook</span>(wb, <span class="at">file =</span> master_data_set_file_name, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./results.html" class="pagination-link" aria-label="Results">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Results</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Kenai-Watershed-Forum/fish-passage-prioritization/edit/main/methods.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>